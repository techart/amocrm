# Утилиты для работы с AmoCRM

## FormIntegrator: отправка лидов(интеграция c формами)

Класс реализует отправку лида в AmoCRM с проверкой существования контакта и его созданием/обновлением. Так же у него есть
несколько вспомогательных методов, которые могут быть полезны.

```php
// Основной метод для отправки лида и привязки его к нужному контакту
public function sendLead(
	$leadName, 
	$email = '', 
	$phone = '', 
	$contactName = '', 
	$leadFields = [], 
	$leadCustomFields = [], 
	$contactCustomFields = []
);

// Находит или создает контакт с переданными параметрами. Если котакт существует, то обновляет его данные при необходимости
public function getOrCreateContact($email, $phone, $name, $customFields = []);

// Создает лид и привязывает его к переданному контакту
public function createLead($name, $contactId, $fields = [], $customFields = []);

// Ищет контакт по переданным параметрам (по очереди использует их в качестве параметра `query` до первого найденного элемента)
public function findContact($attributes);
```

Алгоритм работы метода sendLead:

1. Ищет контакт по переданным параметрам.
2. Если находит, то смотрит не требуется ли обновления его данных(другие параметры).
3. Если не находит, то создает контакт с переданными параметрами.
4. Создает лид
5. Привязывает его к контакту